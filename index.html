<!DOCTYPE html>
<html lang="en">
<head>
<script src="web3.js/dist/web3.min.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script> -->
<script type="text/javascript">

    const testAbi = [
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "purchaser",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "value",
				"type": "uint256"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "TokenPurchase",
		"type": "event"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "buyTokens",
		"outputs": [],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_icoEndTime",
				"type": "uint256"
			}
		],
		"name": "setIcoEndTime",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"internalType": "uint8",
				"name": "_icoState",
				"type": "uint8"
			},
			{
				"internalType": "uint256",
				"name": "_icoStartTime",
				"type": "uint256"
			},
			{
				"internalType": "uint256",
				"name": "_icoEndTime",
				"type": "uint256"
			}
		],
		"name": "setIcoInit",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_icoStartTime",
				"type": "uint256"
			}
		],
		"name": "setIcoStartTime",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"internalType": "uint8",
				"name": "_icoState",
				"type": "uint8"
			}
		],
		"name": "setIcoState",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	},
	{
		"inputs": [
			{
				"internalType": "address payable",
				"name": "_wallet",
				"type": "address"
			},
			{
				"internalType": "contract ZstToken",
				"name": "_token",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getToken",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "icoEndTime",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "icoStartTime",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "limitTierOne",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "limitTierThree",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "limitTierTwo",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "rateOne",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "rateThree",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "rateTwo",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "testValue",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "token",
		"outputs": [
			{
				"internalType": "contract ZstToken",
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "wallet",
		"outputs": [
			{
				"internalType": "address payable",
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "weiRaised",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]

    // ZENSTY Token Address : 0xF5E7F651421fceEF429420187774b7164b1742eb
    // Crow Address : 0xE401598042634bddD552D57257D1e559fBdc2Ae6
	const contractAddress = '0xE401598042634bddD552D57257D1e559fBdc2Ae6';

	if (typeof web3 !== 'undefined') {
		// Mist/MetaMask의 프로바이더 사용
		web3 = new Web3(Web3.givenProvider);
	} else {
		// 사용자가 Metamask를 설치하지 않은 경우에 대해 처리
		// 사용자들에게 Metamask를 설치하라는 등의 메세지를 보여줄 것
		web3 = new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161"));
	}

// 	const Web3 = require("web3");
// 	const ethEnabled = async () => {
// 		if (window.ethereum) {
// 	    		await window.ethereum.send('eth_requestAccounts');
// 	    		window.web3 = new Web3(window.ethereum);
// 	    		return true;
// 		}
// 	  	return false;
// 	}

	async function func1(){

		console.log("1");
		

// 		const test_con = new web3.eth.Contract(testAbi, contractAddress);
// 		const record = await test_con.methods.getToken().call();
// 		alert("record = "+ record);
	}

	function func2(){

		var str = "0xA1EF88f0ea449C54BbaD974c762ab28D5eFAd3b4";

		web3.eth.getBalance(str, function(error, balance){
		    //document.getElementById("Balance").innerText = web3.fromWei(balance, "ether")
		    // document.getElementById("Balance").innerText = balance;
		    alert("balance = "+balance);
		})
	}

	function func3(){

		web3.eth.getAccounts(function(error, accounts) {
			if (error) {
				console.log(error);
				alert("error = "+error);
			}

			var account = accounts[0];

			// const test_con = new web3.eth.Contract(testAbi, contractAddress);
			// const record = test_con.methods.buyTokens().call();

			//web3.personal.unlockAccount(accounts[0], '1');

			// alert("account = "+accounts[0]);
			// alert("account = "+accounts[1]);
			// alert("account = "+accounts[2]);

			// App.contracts.Adoption.deployed().then(function(instance) {
				// adoptionInstance = instance;

				// var input = prompt('question','보낼 돈을 적어주세요');

		// 		return adoptionInstance.adopt(petId, {
		// 			from: account,
		// 			to: '0x9f57E844f4ce99721635F9EBde0DDdB7bEcf01fc',
		// 		value : web3.toWei(input,"ether")
		// 			});


		// 		}).then(function(result) {
	// 	return App.markAdopted();
		// 	}).catch(fdunction(err) {
		// 		console.log(err.message);
		// 	});
		// });

		//alert("web3.eth.getAccounts() = "+ web3.eth.accounts[0]);
		})
	}

	function func4(){

		web3.eth.getAccounts(function(error, accounts) {
			if (error) {
				console.log(error);
				alert("error = "+error);
			}

			var from_account = accounts[0];

			//transaction object 설정
			var transactionObj = { 
				from:from_account,
				to:contractAddress,
				value:document.getElementById("inputEthe").value
			};

			web3.eth.sendTransaction(transactionObj);

		})

	}
	

	function func5(){

		web3.eth.getAccounts(function(error, accounts) {

			if (error) {
				console.log(error);
				alert("error = "+error);
			}

			document.getElementById("userAddress").value = accounts[0];

		})

	}

</script>
</head>

<body>

    <h1>내 이더 지갑 잔고</h1>

    <button onclick="func1()">func1()</button>
    <button onclick="func2()">func2()</button>
    <button onclick="func3()">func3()</button>

    <button onclick="func4()">func4()</button>
	<input type="text" id="inputEthe" />

	<button onclick="func5()">func5()</button>
	<input type="text" id="userAddress" />

</body>
</html>
